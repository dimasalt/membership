var PROGRESS_COOKIE_NAME="progressally-progress-info",PROGRESS_OBJECTIVE_COOKIE_NAME="progressally-objective-info",PROGRESS_COOKIE_DAYS=3650;jQuery(document).ready(function(a){function d(a,b,d){return("touchend"!==a.type||!c)&&d(a,b)}function e(b,c){a(b).each(function(b,e){var f=a(e),g=f.attr("progressally-click-binded");"undefined"!=typeof g&&g!==!1||(f.bind("touchend click",function(a){return d(a,this,c)}),f.attr("progressally-click-binded","yes"))})}function g(b){var c={};return b.find("input").each(function(b,d){var e=a(d),f=e.attr("type"),g=e.attr("name");"undefined"!=typeof f&&0!=f||(f="text"),"undefined"!=typeof g&&g!==!1&&(c[g]=f)}),c}function h(){var b,c;f={},a(".progressally-quiz").each(function(d,e){c=a(e),b=c.attr("post-id"),"undefined"!=typeof b&&b!==!1&&(b in f||(f[b]=g(c)))})}function i(a){var d,e,b=a.attr("post-id"),c=!1;if("undefined"!=typeof b&&b!==!1&&b in f){e=f[b],c=!0;for(d in e)"radio"===e[d]&&0===a.find('input[name="'+d+'"]:checked').length&&(a.find('input[name="'+d+'"]').attr("progressally-error","need-input"),c=!1)}return c}function j(b,c){var d=a(c),e=d.parents(".progressally-quiz"),f=e.parents(".progressally-quiz-container"),g=parseInt(e.attr("post-id")),h=null;return e.find(".progressally-quiz-reset-button").hide(),f.find(".progressally-quiz-wait-overlay").show(),h={action:"progressally_reset_quiz",p:g,progressally_update_nonce:progressally_update.progressally_update_nonce},a.ajax({type:"POST",url:progressally_update.ajax_url,data:h,cache:!1,dataType:"json",success:function(a){try{n(f,g,a)}catch(a){}f.find(".progressally-quiz-wait-overlay").hide()}}),b.stopPropagation(),!1}function l(b){var c=b,d=parseInt(c.attr("post-id")),e=c.attr("key"),f=c.val(),g=null,h={};if(c.is('[type="checkbox"]')){f=!!c.is(":checked"),a('.progressally-update[key="'+e+'"][post-id="'+d+'"]').prop("checked",f);var i=a('.progressally-update[post-id="'+d+'"]');if(i.length>0){var j=i.filter(":checked").length/i.length;p(d,j)}i.each(function(b,c){var d=a(c),e=d.attr("key"),f=d.is(":checked");h[e]=f})}h[e]=f,g={action:"progressally_update_progress",p:d,v:h,progressally_update_nonce:progressally_update.progressally_update_nonce},d in k||(k[d]=0);var l=++k[d];a.ajax({type:"POST",url:progressally_update.ajax_url,data:g,success:function(a){try{if(k[d]===l){var b=JSON.parse(a);m(d,b),k[d]=0}}catch(a){}}})}function m(b,c){if(c&&"progress"in c&&"keys"in c){var d,e;for(d in c.progress){var f=parseFloat(c.progress[d]);p(d,f),f>=1?a('.progressally-status-display[post-id="'+d+'"]').show():a('.progressally-status-display[post-id="'+d+'"]').hide()}for(d in c.keys)for(e in c.keys[d])a('input[type="checkbox"].progressally-update[key="'+e+'"][post-id="'+d+'"]').prop("checked","true"===c.keys[d][e]);"0"===progressally_update.user&&x(c.keys)}}function n(a,b,c){c&&"reset"in c&&"true"===c.reset&&(a.find(".progressally-quiz-correct-message").hide(),a.find(".progressally-quiz-incorrect-message").hide(),a.find(".progressally-quiz-result").empty(),a.find(".progressally-quiz-submit-button").show(),a.find(".progressally-quiz-choice-input").prop("checked",!1).prop("disabled",!1),m(b,c),"0"===progressally_update.user&&"cookie"in c&&v(b,c.cookie))}function o(a,b,c){if(c&&"quiz"in c){var d=c.quiz;if("type"in d&&"result-html"in d){if(a.find(".progressally-quiz-result").html(d["result-html"]),"score"===d.type)for(var e in d.question)"yes"===d.question[e]?a.find("."+e+"-correct-message").show():a.find("."+e+"-incorrect-message").show();"true"===c.reset&&a.find(".progressally-quiz-reset-button").show(),a.find(".progressally-quiz-choice-input:not(:checked)").prop("disabled",!0)}"0"===progressally_update.user&&"cookie"in c&&v(b,c.cookie)}m(b,c)}function p(b,c){var d=a('[progressally-bar-update="'+b+'"]'),e=Math.round(100*c)+"%";d.find(".progressally_progress_bar_overlay").css("width",e),d.find(".progressally_progress_bar_percentage").text(e),d=a('[progressally-text-update="'+b+'"]'),d.text(e),d=a('[progressally-pie-update="'+b+'"]'),c>.5?(d.find(".progressally_progress_pie_right").css("transform","rotate(90deg)"),d.find(".progressally_progress_pie_left").css("transform","rotate("+(Math.round(360*(c-.5))-90)+"deg)")):(d.find(".progressally_progress_pie_right").css("transform","rotate("+(Math.round(360*c)-90)+"deg)"),d.find(".progressally_progress_pie_left").css("transform","rotate(-90deg)")),d.find(".progressally_progress_pie_percentage").text(e),d=a('[progressally-objective-completion-update="'+b+'"]'),1===c?d.show():d.hide()}function q(b,c){var d=a(c),e=d.attr("progressally-video-id"),f=d.attr("progressally-video-time");return Y(e,f,d),b.stopPropagation(),!1}function r(b,c){var d=a(c),e=d.attr("progressally-video-id"),f=d.attr("progressally-video-time");return Q(e,f,d),b.stopPropagation(),!1}function s(b,c){var d=a(c),e=d.attr("progressally-video-id"),f=d.attr("progressally-video-time");return da(e,f,d),b.stopPropagation(),!1}function t(a,b){var c="",d=JSON.stringify(b);date=new Date,date.setTime(date.getTime()+24*PROGRESS_COOKIE_DAYS*60*60*1e3),c="; expires="+date.toGMTString(),document.cookie=a+"="+d+c+"; path=/"}function u(a){if(a){var b=a+"=",c=document.cookie,d=c.indexOf(b);if(d>=0)return d+=b.length,endIndex=c.indexOf(";",d),endIndex<0&&(endIndex=c.length),c.substring(d,endIndex)}return null}function v(a,b){var c=z();a in c||(c[a]=new Object),(null===c[a]||"object"!=typeof c[a]||c[a]instanceof Array)&&(c[a]=new Object),c[a].quiz=b,t(PROGRESS_COOKIE_NAME,c)}function w(a,b){var c=z(),d=!1;a in c||(c[a]=new Object),(null===c[a]||"object"!=typeof c[a]||c[a]instanceof Array)&&(c[a]=new Object),"quiz"in c[a]&&(d=c[a].quiz),null===b||"object"!=typeof b||b instanceof Array?c[a]=new Object:c[a]=b,!1!==d&&(c[a].quiz=d),t(PROGRESS_COOKIE_NAME,c)}function x(b){var d,e,g,c=y(),f=[];for(d in b){d in c||(c[d]=new Object);for(e in b[d])"true"===b[d][e]?c[d][e]="true":e in c[d]&&delete c[d][e];a.isEmptyObject(c[d])&&f.push(d)}for(g=0;g<f.length;++g)delete c[f[g]];t(PROGRESS_OBJECTIVE_COOKIE_NAME,c)}function y(){var a=JSON.parse(u(PROGRESS_OBJECTIVE_COOKIE_NAME));return(null===a||"object"!=typeof a||a instanceof Array)&&(a=new Object),a}function z(){var a=JSON.parse(u(PROGRESS_COOKIE_NAME));return(null===a||"object"!=typeof a||a instanceof Array)&&(a=new Object),a}function A(){return"0"===progressally_update.user?z():progressally_update.user_meta}function B(a,b){"0"===progressally_update.user?w(a,b):progressally_update.user_meta[a]=b}function C(){var b=A();a(".progressally-toggle-trigger").each(function(c,d){D(a(d),b)})}function D(b,c){var d=b.attr("key").split(","),e=b.attr("unchecked-class"),f=b.attr("checked-class"),g=b.attr("selector"),h=a(g),i=0,j=b.attr("post-id"),k=!0;if(j in c){for(c=c[j],i=0;i<d.length;i++)if(!(d[i]in c)||"false"===c[d[i]]){k=!1;break}}else k=!1;"undefined"!=typeof f&&f!==!1&&(k?h.addClass(f):h.removeClass(f)),"undefined"!=typeof e&&e!==!1&&(k?h.removeClass(e):h.addClass(e))}function F(b){var c=b,d=parseInt(c.attr("post-id")),e=c.attr("key"),f=c.val(),g=null,h={};c.is('[type="checkbox"]')&&(f=!!c.is(":checked")),h[e]=f,g={action:"progressally_update_toggle",p:d,v:h,nonce:progressally_update.progressally_update_nonce},d in E||(E[d]=0);var i=++E[d];a.ajax({type:"POST",url:progressally_update.ajax_url,data:g,success:function(a){try{if(E[d]===i){var b=JSON.parse(a);G(d,e,b),E[d]=0}}catch(a){}}})}function G(b,c,d){if(d&&"meta"in d){var e={},f=!1;e[b]=d.meta,B(b,d.meta),a('.progressally-toggle-trigger[post-id="'+b+'"][key="'+c+'"]').each(function(b,c){D(a(c),e)}),c in d.meta&&"true"===d.meta[c]&&(f=!0),a('input.progressally-toggle[post-id="'+b+'"][key="'+c+'"]').prop("checked",f)}}function H(){if("undefined"==typeof YT||"undefined"==typeof YT.Player){var a=document.createElement("script");a.src="https://www.youtube.com/iframe_api";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}}function I(a){var b={};if(a){var d,e,c=a.split("&");for(d=0;d<c.length;++d)e=c[d].split("="),e.length>1&&(b[e[0]]=e[1])}return b}function J(){return"undefined"!=typeof YT&&"undefined"!=typeof YT.Player}function M(a,b,c){var j,d=a.attr("width"),e=a.attr("height"),f=a.attr("arg"),g=I(f),h="progressally-youtube-div-"+b+"-"+c,i={videoId:b,playerVars:g,events:{onStateChange:O}};a.html('<div id="'+h+'"></div>'),d&&(i.width=d),e&&(i.height=e),j=new YT.Player(h,i),j.progressally_video_id=c,K[c]=j}function N(){J()?a("[progressally-youtube-init]").each(function(b,c){var d=a(c),e=d.attr("progressally-youtube-init"),f=d.attr("progressally-youtube-id");M(d,e,f)}):setTimeout(N,1e3)}function O(a){a.data!=-1&&(L[a.target.progressally_video_id]=!0)}function P(a){return a in L}function Q(b,c,d){if(!P(b))return ea(d),!1;if(J()&&b in K)return K[b].seekTo(c,!0),!0;var e=a("#progressally_youtube_"+b);if(1!==e.length)return!1;var f=e.attr("youtube_id"),g=JSON.stringify({event:"command",func:"seekTo",args:[c,!0]}),h="https://www.youtube.com/embed/"+f;return e=e[0],e.contentWindow.postMessage(g,h),!0}function R(a,b,c){var d=JSON.stringify({method:b,value:c});a.contentWindow.postMessage(d,S)}function U(a){var b=a.replace(/progressally_vimeo_/,"");b&&(T[b]=!0)}function V(b){var c=a("#"+b);c.length>0&&R(c[0],"addEventListener","play")}function W(a){if(!/^https?:\/\/player.vimeo.com/.test(a.origin))return!1;"*"===S&&(S=a.origin);var b=JSON.parse(a.data);switch(b.event){case"ready":V(b.player_id);break;case"play":U(b.player_id)}}function X(a){return!fa()||a in T}function Y(b,c,d){var e=a("#progressally_vimeo_"+b);return!(e.length<1)&&(X(b)?(R(e[0],"seekTo",c),!0):(ea(d),!1))}function Z(){if("undefined"==typeof Wistia){var a=document.createElement("script");a.src="//fast.wistia.net/assets/external/E-v1.js";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}}function aa(){var b=a(this.iframe).attr("progressally-wistia-video-id");b&&(_[b]=!0)}function ba(){window._wq=window._wq||[];var b={};a("[progressally-wistia-init]").each(function(c,d){var e=a(d),f=e.attr("progressally-wistia-init"),g=e.attr("progressally-wistia-video-id");b[f]=function(a){$[g]=a,a.bind("play",aa)}}),_wq.push(b)}function ca(a){return!fa()||a in _}function da(a,b,c){return a in $&&(ca(a)?($[a].time(b).play(),!0):(ea(c),!1))}function ea(b){var c=a('<div style="position:absolute;padding:5px;border-radius:5px;border:1px solid #000000;opacity:0;background-color:#ffffff;z-index:9999999;">Please start the video first.</div>');b.css("position","relative"),b.append(c),c.animate({opacity:1},200),setTimeout(function(){c.animate({opacity:0},1e3,function(){c.remove()})},1e3)}function fa(){return navigator.userAgent.match(/(iPad|iPhone|iPod)/g)}function ha(b){++ga,a('[progressally-notes-update-display-container="'+b+'"]').hide();var c=a('[progressally-notes-value="'+b+'"]'),d=la(c.val());d=Math.min(20,Math.max(d+1,8)),c.prop("rows",d),a('[progressally-notes-input-container="'+b+'"]').show(),a('[progressally-notes-value="'+b+'"]').focus().select()}function ia(b){a('[progressally-notes-update-display-container="'+b+'"]').show(),a('[progressally-notes-input-container="'+b+'"]').hide(),a('[progressally-notes-value="'+b+'"]').blur(),--ga}function ja(b){var c=a('[progressally-notes-value="'+b+'"]'),d=c.val(),e=c.attr("post-id"),f=c.attr("note-id"),g=c.attr("ordinal");a('[progressally-notes-wait="'+b+'"]').show();var h={action:"progressally_notes_update",val:d,pid:e,nid:f,ord:g};return a.ajax({type:"POST",url:progressally_update.ajax_url,data:h,success:function(c){try{ka(c,e,f,g)}catch(a){alert(a)}finally{--ga,a('[progressally-notes-update-display-container="'+b+'"]').show(),a('[progressally-notes-input-container="'+b+'"]').hide(),a('[progressally-notes-wait="'+b+'"]').hide(),a('[progressally-notes-value="'+b+'"]').blur()}}}),!1}function ka(b,c,d,e){var f=JSON.parse(b);if(!("status"in f))throw"Invalid response. Please refresh the page and try again.";if("error"===f.status)throw f.message;if("data"in f){var g=a('[progressally-notes-update-display][post-id="'+c+'"][note-id="'+d+'"][ordinal="'+e+'"]');"notes"in f.data&&e in f.data.notes?(a('[progressally-notes-value][post-id="'+c+'"][note-id="'+d+'"][ordinal="'+e+'"]').val(f.data.notes[e].v),g.html(ma(f.data.notes[e].v)),g.attr("progressally-placeholder-status","hide")):(a('[progressally-notes-value][post-id="'+c+'"][note-id="'+d+'"][ordinal="'+e+'"]').val(""),g.text(g.attr("progressally-placeholder")),g.attr("progressally-placeholder-status","show")),"0"===progressally_update.user&&t(f.data.key,f.data.notes)}}function la(a){var b=a.match(/(\r\n|\n\r|\r|\n)/g);return null===b?1:b.length+1}function ma(a){return a=a.replace(/&/g,"&amp;"),a=a.replace(/</g,"&lt;"),a=a.replace(/>/g,"&gt;"),a=a.replace(/\'/g,"&#39;"),a=a.replace(/\"/g,"&quot;"),a=a.replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br/>$2")}function na(){C(),h(),a("[progressally-youtube-init]").length>0&&(H(),setTimeout(N,500)),a("[progressally-wistia-init]").length>0&&(Z(),ba()),a.isFunction(a.fn.on)||(e(".progressally-quiz-reset-button",j),e('[progressally-video-target="vimeo"]',q),e('[progressally-video-target="youtube"]',r),e('[progressally-video-target="wistia"]',s))}if("0"!==progressally_update.user){var b={action:"progressally_track_page_access",post_id:progressally_update.post_id,progressally_update_nonce:progressally_update.progressally_update_nonce};a.ajax({type:"POST",url:progressally_update.ajax_url,data:b,success:!1})}var c=!1;a("html").on("touchstart",function(){c=!1}),a("html").on("touchmove",function(){c=!0}),a(document).on("change",".progressally-update",function(b){l(a(this))});var f={};a(document).on("change",".progressally-quiz input",function(b){var c=a(this),d=c.parents(".progressally-quiz"),e=c.attr("name");"undefined"!=typeof e&&e!==!1&&d.find('input[name="'+e+'"]').attr("progressally-error",!1)}),a(document).on("submit",'[progressally-ajax-action="progressally_submit_quiz"]',function(b){b.preventDefault();var g,c=a(this),d=c.parents(".progressally-quiz-container"),e=parseInt(c.attr("post-id")),f=null;return!!i(c)&&(g=c.serialize(),g=g.replace(/=/g,"|-|"),c.find(".progressally-quiz-submit-button").hide(),f={action:"progressally_submit_quiz",p:e,input:g,progressally_update_nonce:progressally_update.progressally_update_nonce},void a.ajax({type:"POST",url:progressally_update.ajax_url,data:f,cache:!1,dataType:"json",success:function(a){try{o(d,e,a)}catch(a){}}}))});var k={};a(document).on("change",".progressally-toggle",function(b){F(a(this))});var E={},K={},L={};window.addEventListener?window.addEventListener("message",W,!1):window.attachEvent("onmessage",W,!1);var S="*",T={},$={},_={},ga=0;a(document).on("click touchend","[progressally-notes-update]",function(b){var c=a(this),d=c.attr("progressally-notes-update");ha(d)}),a(document).on("click touchend","[progressally-notes-update-display]",function(b){var c=a(this),d=c.attr("progressally-notes-update-display");ha(d)}),a(document).on("keydown","[progressally-notes-value]",function(b){if(27==b.keyCode){b.preventDefault();var c=a(this),d=c.attr("progressally-notes-value");return ia(d),c.blur(),!1}}),a(document).on("click touchend","[progressally-notes-input-save]",function(b){var c=a(this).attr("progressally-notes-input-save");ja(c)}),a(document).on("click touchend","[progressally-notes-input-cancel]",function(b){var c=a(this).attr("progressally-notes-input-cancel");ia(c)}),a.isFunction(a.fn.on)&&(a("html").on("touchend click",".progressally-quiz-reset-button",function(a){return d(a,this,j)}),a("html").on("touchend click",'[progressally-video-target="vimeo"]',function(a){return d(a,this,q)}),a("html").on("touchend click",'[progressally-video-target="youtube"]',function(a){return d(a,this,r)}),a("html").on("touchend click",'[progressally-video-target="wistia"]',function(a){return d(a,this,s)})),na(),document.addEventListener("ambitionallyrefresh",function(a){na()},!1)});